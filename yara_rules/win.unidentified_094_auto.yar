rule win_unidentified_094_auto {

    meta:
        author = "Felix Bilstein - yara-signator at cocacoding dot com"
        date = "2023-03-28"
        version = "1"
        description = "Detects win.unidentified_094."
        info = "autogenerated rule brought to you by yara-signator"
        tool = "yara-signator v0.6.0"
        signator_config = "callsandjumps;datarefs;binvalue"
        malpedia_reference = "https://malpedia.caad.fkie.fraunhofer.de/details/win.unidentified_094"
        malpedia_rule_date = "20230328"
        malpedia_hash = "9d2d75cef573c1c2d861f5197df8f563b05a305d"
        malpedia_version = "20230407"
        malpedia_license = "CC BY-SA 4.0"
        malpedia_sharing = "TLP:WHITE"

    /* DISCLAIMER
     * The strings used in this rule have been automatically selected from the
     * disassembly of memory dumps and unpacked files, using YARA-Signator.
     * The code and documentation is published here:
     * https://github.com/fxb-cocacoding/yara-signator
     * As Malpedia is used as data source, please note that for a given
     * number of families, only single samples are documented.
     * This likely impacts the degree of generalization these rules will offer.
     * Take the described generation method also into consideration when you
     * apply the rules in your use cases and assign them confidence levels.
     */


    strings:
        $sequence_0 = { c745e47ec25e09 c745e8aca99b9a c745ecaf8530e2 c70020000000 e8???????? 6a20 56 }
            // n = 7, score = 100
            //   c745e47ec25e09       | mov                 dword ptr [ebp - 0x1c], 0x95ec27e
            //   c745e8aca99b9a       | mov                 dword ptr [ebp - 0x18], 0x9a9ba9ac
            //   c745ecaf8530e2       | mov                 dword ptr [ebp - 0x14], 0xe23085af
            //   c70020000000         | mov                 dword ptr [eax], 0x20
            //   e8????????           |                     
            //   6a20                 | push                0x20
            //   56                   | push                esi

        $sequence_1 = { c745b734363863 c745bb37383134 c745bf32646565 c745c364353764 c745c765633939 }
            // n = 5, score = 100
            //   c745b734363863       | mov                 dword ptr [ebp - 0x49], 0x63383634
            //   c745bb37383134       | mov                 dword ptr [ebp - 0x45], 0x34313837
            //   c745bf32646565       | mov                 dword ptr [ebp - 0x41], 0x65656432
            //   c745c364353764       | mov                 dword ptr [ebp - 0x3d], 0x64373564
            //   c745c765633939       | mov                 dword ptr [ebp - 0x39], 0x39396365

        $sequence_2 = { 8bd8 8d4589 6a00 50 c6458800 e8???????? 8d4dfc }
            // n = 7, score = 100
            //   8bd8                 | mov                 ebx, eax
            //   8d4589               | lea                 eax, [ebp - 0x77]
            //   6a00                 | push                0
            //   50                   | push                eax
            //   c6458800             | mov                 byte ptr [ebp - 0x78], 0
            //   e8????????           |                     
            //   8d4dfc               | lea                 ecx, [ebp - 4]

        $sequence_3 = { 8a8670aa0110 32c1 8a8e74aa0110 32c2 8845ff }
            // n = 5, score = 100
            //   8a8670aa0110         | mov                 al, byte ptr [esi + 0x1001aa70]
            //   32c1                 | xor                 al, cl
            //   8a8e74aa0110         | mov                 cl, byte ptr [esi + 0x1001aa74]
            //   32c2                 | xor                 al, dl
            //   8845ff               | mov                 byte ptr [ebp - 1], al

        $sequence_4 = { 7903 80f31b 8a867caa0110 32c1 8a8e70aa0110 }
            // n = 5, score = 100
            //   7903                 | jns                 5
            //   80f31b               | xor                 bl, 0x1b
            //   8a867caa0110         | mov                 al, byte ptr [esi + 0x1001aa7c]
            //   32c1                 | xor                 al, cl
            //   8a8e70aa0110         | mov                 cl, byte ptr [esi + 0x1001aa70]

        $sequence_5 = { 6a20 8d4d80 51 56 c745804edf69b3 }
            // n = 5, score = 100
            //   6a20                 | push                0x20
            //   8d4d80               | lea                 ecx, [ebp - 0x80]
            //   51                   | push                ecx
            //   56                   | push                esi
            //   c745804edf69b3       | mov                 dword ptr [ebp - 0x80], 0xb369df4e

        $sequence_6 = { c745e026f1f443 c745e4ea69f85c c745e81826633b c745ec4baec173 }
            // n = 4, score = 100
            //   c745e026f1f443       | mov                 dword ptr [ebp - 0x20], 0x43f4f126
            //   c745e4ea69f85c       | mov                 dword ptr [ebp - 0x1c], 0x5cf869ea
            //   c745e81826633b       | mov                 dword ptr [ebp - 0x18], 0x3b632618
            //   c745ec4baec173       | mov                 dword ptr [ebp - 0x14], 0x73c1ae4b

        $sequence_7 = { c745d4ee07fb78 c745d8c3825d84 c745dc4d51f1b4 c745e039d686b9 }
            // n = 4, score = 100
            //   c745d4ee07fb78       | mov                 dword ptr [ebp - 0x2c], 0x78fb07ee
            //   c745d8c3825d84       | mov                 dword ptr [ebp - 0x28], 0x845d82c3
            //   c745dc4d51f1b4       | mov                 dword ptr [ebp - 0x24], 0xb4f1514d
            //   c745e039d686b9       | mov                 dword ptr [ebp - 0x20], 0xb986d639

        $sequence_8 = { 8d4d80 51 56 c745800ad02191 c74584f45f4e3d c745881905b8ed c7458c3a8e36fb }
            // n = 7, score = 100
            //   8d4d80               | lea                 ecx, [ebp - 0x80]
            //   51                   | push                ecx
            //   56                   | push                esi
            //   c745800ad02191       | mov                 dword ptr [ebp - 0x80], 0x9121d00a
            //   c74584f45f4e3d       | mov                 dword ptr [ebp - 0x7c], 0x3d4e5ff4
            //   c745881905b8ed       | mov                 dword ptr [ebp - 0x78], 0xedb80519
            //   c7458c3a8e36fb       | mov                 dword ptr [ebp - 0x74], 0xfb368e3a

        $sequence_9 = { c7458c217b9533 c74590bf827c67 c7459400d815ad c7459814811e23 c7459c25be8bbc c745a039663866 }
            // n = 6, score = 100
            //   c7458c217b9533       | mov                 dword ptr [ebp - 0x74], 0x33957b21
            //   c74590bf827c67       | mov                 dword ptr [ebp - 0x70], 0x677c82bf
            //   c7459400d815ad       | mov                 dword ptr [ebp - 0x6c], 0xad15d800
            //   c7459814811e23       | mov                 dword ptr [ebp - 0x68], 0x231e8114
            //   c7459c25be8bbc       | mov                 dword ptr [ebp - 0x64], 0xbc8bbe25
            //   c745a039663866       | mov                 dword ptr [ebp - 0x60], 0x66386639

    condition:
        7 of them and filesize < 231424
}